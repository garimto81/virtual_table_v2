# 다음 개발 작업 목록 (Next Development Tasks)

## ✅ **완료된 작업들 (v2.1.0)**

### 🎉 **1단계: 데이터 문제 해결 (완료)**
- [x] **데이터 로딩 버그 수정** - 96개 전체 데이터 정상 로드
- [x] **SheetDataMapper 헤더 감지 로직 개선**
- [x] **UI와 API 완전 연동**
  - DataService에 Sheet 메서드 추가 (loadSheetData, testSheetConnection)
  - 포커룸/테이블 선택 이벤트 연결 완료
  - 플레이어 자동 로드 기능 구현
- [x] **함수명 불일치 해결** - confirmPlayerSelection 통일
- [x] **에러 처리 강화** - 빈 데이터 검증 및 친화적 메시지

### 📊 **현재 상태 (2025-09-26)**
- **서버**: 정상 작동 (localhost:3007)
- **Google Sheets API**: Direct API 연결 성공
- **데이터 로드**: 11개 테이블, 96개 플레이어 정상 처리
- **UI 플로우**: 완전 작동 (로그인 → 로드 → 선택 → 플레이어 → 핸드)

---

## 🚀 **다음 개발 단계 (우선순위별)**

### ✅ **완료 - Phase 4.5: 데이터 매핑 문제 해결** (2025-09-26)

### 📊 **Task 4.5.1: SheetDataMapper 헤더 처리 수정**
**목표**: 헤더 행이 플레이어 데이터로 처리되는 문제 해결

**현재 문제점**:
- 헤더 행(`Poker Room`, `Table Name`, etc.)이 "Players"라는 가짜 플레이어로 생성됨
- 범위 설정(A1:H vs A2:H)에 따라 헤더 감지 로직이 일관되지 않음
- 시스템이 헤더를 실제 데이터로 인식하여 잘못된 테이블 생성

**작업 내용**:
- [ ] 헤더 감지 로직 강화 (`Poker Room_Table Name_Table No.` 패턴 감지)
- [ ] 다양한 범위(A1:H, A2:H)에서 일관된 헤더 처리
- [ ] 헤더 행 완전 제거 로직 구현
- [ ] 디버깅 로그 개선으로 헤더 처리 과정 추적

**예상 시간**: 30분
**우선순위**: 🚨 긴급

---

### 🔥 **Task 4.5.2: 8개 컬럼 필수 구조 적용**
**목표**: 7개 컬럼 행이 스킵되는 "컬럼 수 부족 (7/8)" 문제 해결

**현재 문제점**:
- 96개 행 중 7개 컬럼만 있는 행들이 "컬럼 수 부족" 오류로 스킵됨
- Keyplayer 컬럼이 없는 행들이 처리되지 않음
- 실제로 1-2개 테이블의 플레이어만 로드됨

**작업 내용**:
- [ ] 8개 컬럼 필수 구조로 변경
- [ ] 7개 컬럼 행에 대해 Keyplayer를 기본값(false)로 처리
- [ ] 컬럼 수 검증 로직 개선
- [ ] 핵심 필드 재정의: Table No, Seat No, Players, Nationality, Chips, Keyplayer

**예상 시간**: 45분
**우선순위**: 🚨 긴급

---

### 🎯 **Task 4.5.3: 범위 설정 표준화**
**목표**: 모든 Google Sheets 호출에서 일관된 범위 사용

**작업 내용**:
- [ ] `sheets.js` 라우트에서 `A2:H` (헤더 제외)로 통일
- [ ] GoogleSheetsService에서 범위 설정 표준화
- [ ] 테스트 호출 시에도 헤더 행 필터링 보장
- [ ] 범위별 데이터 처리 로직 일관성 확보

**예상 시간**: 20분
**우선순위**: 🔥 최고

---

### 🧪 **Task 4.5.4: 데이터 검증 및 테스트**
**목표**: 96개 플레이어 데이터 전체 정상 로드 확인

**검증 기준**:
- [ ] 96개 플레이어 모두 정상 로드 (현재: 1-2개 테이블만)
- [ ] "Players"라는 가짜 플레이어 생성되지 않음
- [ ] 모든 행이 "컬럼 수 부족" 오류 없이 처리됨
- [ ] 테이블별 정확한 플레이어 그룹핑
- [ ] 국가, 칩, 키플레이어 정보 정확한 매칭

**작업 내용**:
- [ ] 로컬 테스트 실행 및 로그 분석
- [ ] 각 테이블별 플레이어 수 검증
- [ ] 데이터 무결성 확인 (필수 필드 누락 여부)
- [ ] UI에서 정상 데이터 표시 확인

**예상 시간**: 30분
**우선순위**: 🔥 최고

---

### 🔥 **다음 우선순위 - Phase 5: 핸드 기록 시스템**
**✅ Phase 4.5 완료됨 - 진행 가능**

### 📝 **Task 5.1: 핸드 로거 완성**
**목표**: 선택된 플레이어들로 실제 핸드 기록 시작

**작업 내용**:
- [ ] startNewHand() 함수와 선택된 테이블/플레이어 연동
- [ ] 핸드 데이터 구조 설계
  ```javascript
  handData = {
    tableInfo: selectedTable,
    players: selectedPlayers,
    dealerButton: dealerPosition,
    cameraPosition: cameraPosition,
    timestamp: new Date(),
    actions: []
  }
  ```
- [ ] 핸드 진행 상태 UI 개선

**예상 시간**: 2시간
**우선순위**: 🔥 최고

---

### 🎮 **Task 5.2: 액션 기록 시스템**
**목표**: 플레이어 액션 (폴드, 콜, 레이즈 등) 기록

**작업 내용**:
- [ ] 액션 버튼과 선택된 플레이어 연결
- [ ] 액션 순서 관리 (딜러 버튼 기준)
- [ ] 베팅 금액 계산기와 연동
- [ ] 액션 히스토리 저장

**예상 시간**: 3시간
**우선순위**: 🔥 최고

---

### 💾 **Task 5.3: 데이터 저장 및 동기화**
**목표**: 핸드 데이터를 Google Sheets에 저장

**작업 내용**:
- [ ] 새로운 시트 생성 (Hands 시트)
- [ ] 핸드 데이터 → Sheets 변환 로직
- [ ] 오프라인 모드 지원 (로컬 저장 → 나중에 동기화)

**예상 시간**: 2시간
**우선순위**: 🟡 높음

---

## 🔧 **Phase 6: 시스템 최적화**

### 📊 **Task 6.1: 실시간 데이터 모니터링 개선**
**목표**: 데이터 변경 감지 및 실시간 업데이트 최적화

**작업 내용**:
- [ ] WebSocket 연결 안정성 개선
- [ ] 데이터 변경 감지 알고리즘 최적화
- [ ] 대용량 데이터 처리 성능 개선
- [ ] 캐시 무효화 전략 개선

**예상 시간**: 4시간
**우선순위**: 🟢 보통

---

### 🛡️ **Task 6.2: 에러 처리 및 복구 시스템**
**목표**: 다양한 장애 상황에서의 시스템 안정성 확보

**작업 내용**:
- [ ] 네트워크 오류 시 자동 재시도 로직
- [ ] 부분 데이터 손실 복구 메커니즘
- [ ] 오프라인/온라인 전환 처리
- [ ] 사용자에게 명확한 상태 피드백

**예상 시간**: 3시간
**우선순위**: 🟢 보통

---

## 🎯 **Phase 7: 사용자 경험 개선**

### 📱 **Task 7.1: 모바일 최적화**
**목표**: 스마트폰 환경에서의 사용성 개선

**작업 내용**:
- [ ] 반응형 디자인 완성 (현재 부분 구현)
- [ ] 터치 인터페이스 최적화
- [ ] PWA (Progressive Web App) 구현
- [ ] 오프라인 캐싱 전략

**예상 시간**: 6시간
**우선순위**: 🟡 높음

---

### 📈 **Task 7.2: 통계 및 분석 대시보드**
**목표**: 플레이어별, 테이블별 상세 통계 제공

**작업 내용**:
- [ ] 플레이어 성과 분석 (VPIP, PFR, 승률 등)
- [ ] 테이블별 수익성 분석
- [ ] 시간대별 패턴 분석
- [ ] 차트 및 그래프 구현

**예상 시간**: 8시간
**우선순위**: 🟡 높음

---

## 🔒 **Phase 8: 보안 및 배포**

### 🛡️ **Task 8.1: 보안 강화**
**목표**: 프로덕션 환경에서의 보안 수준 확보

**작업 내용**:
- [ ] JWT 토큰 보안 강화
- [ ] HTTPS 강제 적용
- [ ] API 레이트 리미팅 개선
- [ ] 입력 검증 강화 (SQL Injection, XSS 방지)

**예상 시간**: 4시간
**우선순위**: 🔥 최고 (배포 전 필수)

---

### 🚀 **Task 8.2: 프로덕션 배포 준비**
**목표**: 실제 운영 환경에서의 안정적 서비스

**작업 내용**:
- [ ] Docker 컨테이너화
- [ ] 환경변수 관리 체계화
- [ ] 모니터링 및 로깅 시스템
- [ ] 백업 및 복구 전략

**예상 시간**: 12시간
**우선순위**: 🟡 높음

---

## 📅 **개발 로드맵**

### **2025년 9월 (현재)**
- ✅ v2.1.0: UI와 API 연동 완료
- 🚀 **다음**: Phase 5 - 핸드 기록 시스템 완성

### **2025년 10월 예정**
- Phase 6: 시스템 최적화
- Phase 7: 사용자 경험 개선

### **2025년 11월 예정**
- Phase 8: 보안 및 프로덕션 배포
- v3.0.0 릴리스

---

## 📊 **기술 부채 관리**

### 🔧 **리팩토링 필요 항목**
- [ ] Apps Script 방식 정리 (현재 Direct API만 사용)
- [ ] 코드 모듈화 개선
- [ ] 타입스크립트 도입 검토
- [ ] 테스트 커버리지 개선

### 📝 **문서화 개선**
- [ ] API 문서 자동화 (Swagger)
- [ ] 사용자 매뉴얼 작성
- [ ] 개발자 가이드 업데이트

---

## 🎯 **최종 목표 (v3.0.0)**

1. **완전한 포커 핸드 관리 시스템**
2. **실시간 Google Sheets 동기화**
3. **모바일 최적화된 PWA**
4. **상세 통계 및 분석 기능**
5. **엔터프라이즈급 보안 수준**

**현재 진행률**: 95% (UI 연동 완료)
**v3.0.0 목표 달성률**: 70%

---

## 📅 **마지막 업데이트**: 2025-09-26 v2.1.0
**다음 마일스톤**: Phase 5 - 핸드 기록 시스템 (예상 7시간)
- [ ] WebSocket 연결 안정성 개선
- [ ] 데이터 변경 감지 알고리즘 최적화
- [ ] 대용량 데이터 처리 성능 개선
- [ ] 캐시 무효화 전략 개선

**예상 시간**: 1.5시간
**우선순위**: 🟢 보통

---

## 🎨 **4단계: UI/UX 개선**

### 🖥️ **Task 4.1: 데이터 표시 UI 개선**
**목표**: 사용자가 포커 테이블 데이터를 쉽게 확인할 수 있도록 개선

**작업 내용**:
- [ ] 테이블별 플레이어 목록 그룹화 표시
- [ ] 키 플레이어 하이라이팅
- [ ] 국가별 필터링 기능
- [ ] 칩 보유량 기준 정렬 기능
- [ ] 반응형 디자인 적용

**예상 시간**: 2시간
**우선순위**: 🔵 낮음

---

### 📱 **Task 4.2: 모바일 최적화**
**목표**: 모바일 환경에서도 원활한 사용 가능

**작업 내용**:
- [ ] 모바일 레이아웃 최적화
- [ ] 터치 인터페이스 개선
- [ ] 데이터 로딩 성능 최적화
- [ ] 오프라인 모드 지원

**예상 시간**: 3시간
**우선순위**: 🔵 낮음

---

## ⚡ **즉시 실행 권장 작업**

### 🏃‍♂️ **지금 바로 시작할 작업들**

1. **Apps Script 응답 로깅 추가** (5분)
   ```javascript
   console.log('📊 Apps Script 원시 응답:', JSON.stringify(response.data, null, 2));
   ```

2. **Google Sheets 직접 확인** (5분)
   - 브라우저에서 스프레드시트 접근
   - Type 시트의 A2:H 범위 데이터 확인

3. **SheetDataMapper 디버깅 로그 추가** (10분)
   ```javascript
   console.log('🔄 변환 입력:', rows);
   console.log('🎯 변환 결과:', result);
   ```

---

## 📋 **작업 진행 체크리스트**

### **오늘 완료 목표**
- [ ] Apps Script 원시 데이터 분석 완료
- [ ] Type 시트 실제 데이터 상태 파악
- [ ] SheetDataMapper 디버깅 완료
- [ ] 테스트 데이터로 1회 이상 성공적인 데이터 로딩

### **이번 주 완료 목표**
- [ ] 안정적인 실시간 데이터 로딩 시스템 구축
- [ ] 에러 핸들링 강화
- [ ] 기본적인 UI 개선

### **다음 주 완료 목표**
- [ ] 고급 기능 (필터링, 정렬) 구현
- [ ] 모바일 최적화
- [ ] 성능 최적화

---

## 📞 **문제 발생 시 체크 포인트**

1. **Apps Script 응답이 여전히 빈 데이터인 경우**:
   - Google Sheets 권한 확인
   - Apps Script 배포 상태 확인
   - SPREADSHEET_ID 정확성 재검증

2. **SheetDataMapper 변환 실패**:
   - 입력 데이터 형식 확인
   - 8컬럼 구조 매칭 여부 확인
   - null/undefined 값 처리 로직 검토

3. **네트워크 연결 문제**:
   - CORS 정책 재확인
   - Apps Script URL 유효성 검증
   - 타임아웃 설정 적절성 확인

---

## 📋 **Phase 4.5 완료 체크리스트**

### ✅ **완료 확인 기준** (모든 항목 달성)
- [x] **헤더 처리 검증**: "Players"라는 가짜 플레이어가 생성되지 않음 ✓
- [x] **데이터 완전성**: 96개 플레이어 모두 정상 로드됨 ✓
- [x] **컬럼 처리**: "컬럼 수 부족 (7/8)" 오류 없음 ✓
- [x] **테이블 그룹핑**: 11개 테이블 정확한 플레이어 분배 ✓
- [x] **필드 매칭**: 국가, 칩, 키플레이어 정보 정확히 매칭 ✓
- [x] **범위 통일**: 모든 API 호출이 A2:H 사용 ✓

### 📊 **성공 지표** ✅ (목표 달성)
- **Before**: 1-2개 테이블, 2개 플레이어 처리 + 가짜 "Players" 생성
- **After**: ✅ 11개 테이블, 96개 플레이어 완전 처리 (100% 성공)
- **에러율**: ✅ "컬럼 수 부족" 0% (기존 80%+ 스킵 → 완전 해결)

---

**📅 작성일**: 2025-09-25
**🔄 마지막 업데이트**: 2025-09-26 (Phase 4.5 완료)
**👨‍💻 작성자**: Claude AI Assistant